<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BLOCKS SDK: Tic Tac Toe</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The BLOCKS SDK
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('example_tic_tac_toe.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Tic Tac Toe </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="tic_tac_toe_introduction"></a>
Introduction</h1>
<p>Implement the classic game of Tic Tac Toe on the Lightpad <a class="el" href="classBlock.html" title="Represents an individual BLOCKS device.">Block</a>.</p>
<p>Launch the BLOCKS CODE application and open the script called <code class="filename">TicTacToe.littlefoot</code>. You can find the script in the <code class="filename">littlefoot/scripts/Example Scripts</code> folder. If you don't have the BLOCKS CODE IDE installed on your system, please refer to the section <a class="el" href="getting_started_with_blocks_code.html">Getting started with BLOCKS CODE</a> for help.</p>
<h1><a class="anchor" id="tic_tac_toe_drawing_grid"></a>
Drawing the Grid</h1>
<p>Let's start by defining global variables to save the current state of the game. To define global variables in LittleFoot simply place your variables outside any function declaration and at the top of the file for convenience. We first have 9 variables for the state of each cell in the grid, a <code class="project_code">currentTurn</code> variable for the current player's turn and a <code class="project_code">winner</code> variable to determine which player is the winner.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> tl, t, tr;</div>
<div class="line"><span class="keywordtype">int</span> ml, m, mr;</div>
<div class="line"><span class="keywordtype">int</span> bl, b, br;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> currentTurn;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> winner;</div>
</div><!-- fragment --><p>The <a class="el" href="group__LittleFootFunctions.html#ga18abf8b19283101238a77c9e6865b673" title="Called when a program is loaded onto the block and is about to start.">initialise()</a> function in the littlefoot language is useful to initialise variables and the state of your script as the function is called once when the program is loaded onto the device. Here we set all the cells to 0, a number chosen to define the blank state of a cell, the current turn to player 1 and the winner to 0, again a number chosen to define the ongoing state of the game.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#ga18abf8b19283101238a77c9e6865b673">initialise</a>()</div>
<div class="line">{</div>
<div class="line">    tl = 0;</div>
<div class="line">    t  = 0;</div>
<div class="line">    tr = 0;</div>
<div class="line">    ml = 0;</div>
<div class="line">    m  = 0;</div>
<div class="line">    mr = 0;</div>
<div class="line">    bl = 0;</div>
<div class="line">    b  = 0;</div>
<div class="line">    br = 0;</div>
<div class="line"> </div>
<div class="line">    currentTurn = 1;</div>
<div class="line">    winner = 0;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga18abf8b19283101238a77c9e6865b673"><div class="ttname"><a href="group__LittleFootFunctions.html#ga18abf8b19283101238a77c9e6865b673">initialise</a></div><div class="ttdeci">void initialise()</div><div class="ttdoc">Called when a program is loaded onto the block and is about to start.</div></div>
</div><!-- fragment --><p>In the <a class="el" href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f" title="Use this method to draw the display.">repaint()</a> function, we first clear the display as usual and check if a winner has been selected. If not, this means the game is still ongoing and we proceed to draw a grid and signs if there are any. Otherwise we draw the winner screen.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f">repaint</a>()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#gafaa5f070126ac5184a648b484e7cf276">clearDisplay</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (winner == 0)</div>
<div class="line">    {</div>
<div class="line">        drawGrid();</div>
<div class="line">        drawSigns();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        drawWinner();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_gac827b978aa122f136a14c198687ad80f"><div class="ttname"><a href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f">repaint</a></div><div class="ttdeci">void repaint()</div><div class="ttdoc">Use this method to draw the display.</div></div>
<div class="ttc" id="agroup__LittleFootFunctions_html_gafaa5f070126ac5184a648b484e7cf276"><div class="ttname"><a href="group__LittleFootFunctions.html#gafaa5f070126ac5184a648b484e7cf276">clearDisplay</a></div><div class="ttdeci">void clearDisplay()</div><div class="ttdoc">Clears the display and sets all the LEDs to black.</div></div>
</div><!-- fragment --><p>In order to draw the default grid, we have created a helper function called drawGrid() which is called in the previously defined <a class="el" href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f" title="Use this method to draw the display.">repaint()</a> function. We first define a variable to the colour white and proceed to draw a rectangle if the cell is still unoccupied.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> drawGrid()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> white = <a class="code" href="group__LittleFootFunctions.html#ga70967dcba6beea8a66f216f75619ff35">makeARGB</a> (255, 200, 200, 200);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (tl == 0) drawRect (white, 0,  0,  5, 5);</div>
<div class="line">    <span class="keywordflow">if</span> (t  == 0) drawRect (white, 5,  0,  5, 5);</div>
<div class="line">    <span class="keywordflow">if</span> (tr == 0) drawRect (white, 10, 0,  5, 5);</div>
<div class="line">    <span class="keywordflow">if</span> (ml == 0) drawRect (white, 0,  5,  5, 5);</div>
<div class="line">    <span class="keywordflow">if</span> (m  == 0) drawRect (white, 5,  5,  5, 5);</div>
<div class="line">    <span class="keywordflow">if</span> (mr == 0) drawRect (white, 10, 5,  5, 5);</div>
<div class="line">    <span class="keywordflow">if</span> (bl == 0) drawRect (white, 0,  10, 5, 5);</div>
<div class="line">    <span class="keywordflow">if</span> (b  == 0) drawRect (white, 5,  10, 5, 5);</div>
<div class="line">    <span class="keywordflow">if</span> (br == 0) drawRect (white, 10, 10, 5, 5);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga70967dcba6beea8a66f216f75619ff35"><div class="ttname"><a href="group__LittleFootFunctions.html#ga70967dcba6beea8a66f216f75619ff35">makeARGB</a></div><div class="ttdeci">int makeARGB(int alpha, int red, int green, int blue)</div><div class="ttdoc">Combines a set of 8-bit ARGB values into a 32-bit colour and returns the result.</div></div>
</div><!-- fragment --><p>This is performed on each cell using the helper function drawRect() defined below which takes as argument a colour, the coordinates and the size of the rectangle.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> drawRect (<span class="keywordtype">int</span> colour, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (colour, x, y, 1, h);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (colour, x, y, w, 1);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (colour, x + w - 1, y,         1, h);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (colour, x,         y + h - 1, w, 1);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga7900085e8a95e1301bde50558bdc56d7"><div class="ttname"><a href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a></div><div class="ttdeci">void fillRect(int rgb, int x, int y, int width, int height)</div><div class="ttdoc">Fills a rectangle on the display with a specified colour.</div></div>
</div><!-- fragment --><p>Notice here we use the built-in <a class="el" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7" title="Fills a rectangle on the display with a specified colour.">fillRect()</a> function with either a width or height of 1 to draw lines for the four sides of the rectangle because we don't want the rectangle to be filled.</p>
<div class="image">
<img src="example_tictactoe_grid.JPG" alt=""/>
<div class="caption">
The Tic Tac Toe grid</div></div>
<h1><a class="anchor" id="tic_tac_toe_drawing_signs"></a>
Drawing the Signs</h1>
<p>Now let's see how we can draw the player signs if any of the cells are occupied. The drawSigns() function called in the <a class="el" href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f" title="Use this method to draw the display.">repaint()</a> loop checks every cell using the evaluate() helper function defined after. It passes the cell variables along with the coordinates in case we need to draw the signs.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> drawSigns()</div>
<div class="line">{</div>
<div class="line">    evaluate (tl, 0,   0);</div>
<div class="line">    evaluate (t , 5,   0);</div>
<div class="line">    evaluate (tr, 10,  0);</div>
<div class="line"> </div>
<div class="line">    evaluate (ml, 0,   5);</div>
<div class="line">    evaluate (m,  5,   5);</div>
<div class="line">    evaluate (mr, 10,  5);</div>
<div class="line"> </div>
<div class="line">    evaluate (bl, 0,  10);</div>
<div class="line">    evaluate (b,  5,  10);</div>
<div class="line">    evaluate (br, 10, 10);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The evaluate() function below checks if the cell variable has been switched to a player index of 1 or 2 in which case we need to draw the corresponding player sign. If the cell variable is still set to 0 this means that the cell is still blank and we keep the white default square.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> evaluate (<span class="keywordtype">int</span> value, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (value == 1)</div>
<div class="line">        drawX (x, y);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value == 2)</div>
<div class="line">        drawO (x, y);</div>
<div class="line">}</div>
</div><!-- fragment --><p>To draw player 1's "X" sign, we first define the player colour and draw each point in the two diagonals as follows:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> drawX (<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> xColour = <a class="code" href="group__LittleFootFunctions.html#ga70967dcba6beea8a66f216f75619ff35">makeARGB</a> (255, 0, 255, 0);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x,     y,     1, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x + 1, y + 1, 1, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x + 2, y + 2, 1, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x + 3, y + 3, 1, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x + 4, y + 4, 1, 1);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x + 4, y,     1, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x + 3, y + 1, 1, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x + 2, y + 2, 1, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x + 1, y + 3, 1, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, x,     y + 4, 1, 1);</div>
<div class="line">}</div>
</div><!-- fragment --><p>To draw player 2's "O" sign, we first define the player colour and draw the four sides like so:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> drawO (<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> oColour = <a class="code" href="group__LittleFootFunctions.html#ga70967dcba6beea8a66f216f75619ff35">makeARGB</a> (255, 0, 0, 255);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (oColour, x,     y,     5, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (oColour, x,     y + 4, 5, 1);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (oColour, x,     y,     1, 5);</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (oColour, x + 4, y,     1, 5);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="tic_tac_toe_handling_touch_events"></a>
Handling Touch Events</h1>
<p>In its current implementation state, our script won't receive any touch events and therefore the game will stay in the blank state with a white grid showing. Let's implement the <a class="el" href="group__LittleFootFunctions.html#ga1037467281f60ab95f5e5a305a41e73b" title="Called when a touch event starts.">touchStart()</a> callback to receive player moves.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#ga1037467281f60ab95f5e5a305a41e73b">touchStart</a> (<span class="keywordtype">int</span> index, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z, <span class="keywordtype">float</span> vz)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> xPos = int (x * 7);</div>
<div class="line">    <span class="keywordtype">int</span> yPos = int (y * 7);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> index = getIndex (xPos, yPos);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (setValueForIndex (index, currentTurn))</div>
<div class="line">    {</div>
<div class="line">        currentTurn = currentTurn == 1 ? 2 : 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (xHasWon()) winner = 1;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oHasWon()) winner = 2;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga1037467281f60ab95f5e5a305a41e73b"><div class="ttname"><a href="group__LittleFootFunctions.html#ga1037467281f60ab95f5e5a305a41e73b">touchStart</a></div><div class="ttdeci">void touchStart(int index, float x, float y, float z, float vz)</div><div class="ttdoc">Called when a touch event starts.</div></div>
</div><!-- fragment --><p>In the above function, we first convert the device coordinates into LED grid coordinates by multiplying both x and y variables by 7. Device coordinates are defined using the number of DNA connectors on the side of the device so for example in the case of a Lightpad Block, the device has a size of 2x2 and therefore the device coordinates will range from 0.0 to 2.0 on each x and y dimensions. Multiplying this range by 7 gives us the LED grid coordinates ranging from 0 to 14 inclusive.</p>
<p>Now using these grid coordinates, we use the <code class="project_code">getIndex()</code> helper function defined below to retrieve the cell index ranging from 0 to 8 from our 3x3 game grid.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> getIndex (<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> xInd = x / 5;</div>
<div class="line">    <span class="keywordtype">int</span> yInd = y / 5;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> yInd * 3 + xInd;</div>
<div class="line">}</div>
</div><!-- fragment --><p>When the index is retrieved we attempt to set a cell variable value only if the touched cell is unoccupied. If a value has been successfully set for the current player, the function returns true and the <code class="project_code">currentTurn</code> variable is switched to the other player.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> setValueForIndex (<span class="keywordtype">int</span> index, <span class="keywordtype">int</span> value)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (index == 0) { tl = tl == 0 ? value : tl; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    <span class="keywordflow">if</span> (index == 1) { t  = t  == 0 ? value : t ; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    <span class="keywordflow">if</span> (index == 2) { tr = tr == 0 ? value : tr; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    <span class="keywordflow">if</span> (index == 3) { ml = ml == 0 ? value : ml; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    <span class="keywordflow">if</span> (index == 4) { m  = m  == 0 ? value : m ; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    <span class="keywordflow">if</span> (index == 5) { mr = mr == 0 ? value : mr; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    <span class="keywordflow">if</span> (index == 6) { bl = bl == 0 ? value : bl; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    <span class="keywordflow">if</span> (index == 7) { b  = b  == 0 ? value : b ; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line">    <span class="keywordflow">if</span> (index == 8) { br = br == 0 ? value : br; <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><div class="image">
<img src="example_tictactoe_signs.JPG" alt=""/>
<div class="caption">
The Tic Tac Toe signs</div></div>
<h1><a class="anchor" id="tic_tac_toe_determining_winner"></a>
Determining a Winner</h1>
<p>We were able to implement the basic gameplay but we don't have a mechanism to select a winner yet. As a last step to the <a class="el" href="group__LittleFootFunctions.html#ga1037467281f60ab95f5e5a305a41e73b" title="Called when a touch event starts.">touchStart()</a> callback, we check if a winner has been selected by calling respectively the <code class="project_code">xHasWon()</code> and <code class="project_code">oHasWon()</code> helper functions defined as follows:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> xHasWon() { <span class="keywordflow">return</span> hasWon (1); }</div>
<div class="line"><span class="keywordtype">bool</span> oHasWon() { <span class="keywordflow">return</span> hasWon (2); }</div>
</div><!-- fragment --><p>These in turn call the <code class="project_code">hasWon()</code> function with the player number which checks all 8 possible combination of winning lines (3 horizontal, 3 vertical and 2 diagonal).</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> hasWon (<span class="keywordtype">int</span> player)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> (tl == player &amp;&amp; t  == player &amp;&amp; tr == player)</div>
<div class="line">        || (ml == player &amp;&amp; m  == player &amp;&amp; mr == player)</div>
<div class="line">        || (bl == player &amp;&amp; b  == player &amp;&amp; br == player)</div>
<div class="line"> </div>
<div class="line">        || (tl == player &amp;&amp; ml == player &amp;&amp; bl == player)</div>
<div class="line">        || (t  == player &amp;&amp; m  == player &amp;&amp; b  == player)</div>
<div class="line">        || (tr == player &amp;&amp; mr == player &amp;&amp; br == player)</div>
<div class="line"> </div>
<div class="line">        || (tl == player &amp;&amp; m  == player &amp;&amp; br == player)</div>
<div class="line">        || (tr == player &amp;&amp; m  == player &amp;&amp; bl == player);</div>
<div class="line">}</div>
</div><!-- fragment --><p>If a winner is selected the <a class="el" href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f" title="Use this method to draw the display.">repaint()</a> function will call the <code class="project_code">drawWinner()</code> function defined below and fill the screen with the appropriate winner's colour:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> drawWinner()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (winner == 1)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> xColour = <a class="code" href="group__LittleFootFunctions.html#ga70967dcba6beea8a66f216f75619ff35">makeARGB</a> (255, 0, 255, 0);</div>
<div class="line">        <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (xColour, 0, 0, 15, 15);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (winner == 2)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> oColour = <a class="code" href="group__LittleFootFunctions.html#ga70967dcba6beea8a66f216f75619ff35">makeARGB</a> (255, 0, 0, 255);</div>
<div class="line">        <a class="code" href="group__LittleFootFunctions.html#ga7900085e8a95e1301bde50558bdc56d7">fillRect</a> (oColour, 0, 0, 15, 15);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>As a final step we can implement a simple way to reset the game back to the beginning by calling the <a class="el" href="group__LittleFootFunctions.html#ga18abf8b19283101238a77c9e6865b673" title="Called when a program is loaded onto the block and is about to start.">initialise()</a> function ourselves when the side button of the device is pressed. This is achieved by implementing the <a class="el" href="group__LittleFootFunctions.html#ga855e263a16ef092ef1c4891d353e2e76" title="Called when a button is pushed.">handleButtonDown()</a> callback function like this:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#ga855e263a16ef092ef1c4891d353e2e76">handleButtonDown</a> (<span class="keywordtype">int</span> index)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga18abf8b19283101238a77c9e6865b673">initialise</a>();</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga855e263a16ef092ef1c4891d353e2e76"><div class="ttname"><a href="group__LittleFootFunctions.html#ga855e263a16ef092ef1c4891d353e2e76">handleButtonDown</a></div><div class="ttdeci">void handleButtonDown(int index)</div><div class="ttdoc">Called when a button is pushed.</div></div>
</div><!-- fragment --><h1><a class="anchor" id="tic_tac_toe_summary"></a>
Summary</h1>
<p>In this example, we learnt how to recreate the classic game of Tic Tac Toe on the Lightpad Block.</p>
<h1><a class="anchor" id="tic_tac_toe_see_also"></a>
See also</h1>
<ul>
<li><a class="el" href="example_dynamic_parameters.html">Dynamic Parameters</a></li>
<li><a class="el" href="example_colour_pressure_map.html">Colour Pressure Map</a></li>
<li><a class="el" href="example_music_gen.html">Music Gen</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr class="footer"/>
<address class="footer"><small>All content &copy ROLI Ltd.</small></address><br/>
</body>
</html>
