<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BLOCKS SDK: Discovering BLOCKS</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The BLOCKS SDK
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('discovering_blocks.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Discovering BLOCKS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Any BLOCKS application would be pretty limited without the ability to discover the BLOCKS that are connected to your computer.</p>
<p>This page gives an overview of the classes and methods available to aid BLOCKS discovery and provides sample code for getting notifications of any connections or disconnections.</p>
<h1><a class="anchor" id="the_block_topology_object"></a>
The BlockTopology object</h1>
<p>Groups of connected Lightpad and Control Blocks are described by a <a class="el" href="structBlockTopology.html" title="Describes a set of blocks and the connections between them.">BlockTopology</a>.</p>
<p>A BlockTopology contains an array of references to <a class="el" href="classBlock.html" title="Represents an individual BLOCKS device.">Block</a> objects, which provide access to Lightpad and Control Block functionality, and an array of <a class="el" href="structBlockDeviceConnection.html" title="Describes a physical connection between two ports of two block devices.">BlockDeviceConnection</a> objects, which describe the connections between devices. Once you have a BlockTopology you have all the information required to visualise and interact with your Lightpads and Control Blocks. For more information about using Block objects see <a class="el" href="discovering_blocks.html#the_block_object">The Block object</a> section.</p>
<p>For Lightpads and Control Blocks, a BlockTopology can be obtained from a <a class="el" href="classPhysicalTopologySource.html" title="This topology source manages the topology of the physical Blocks devices that are currently connected...">PhysicalTopologySource</a>.</p>
<h1><a class="anchor" id="the_physical_topology_source_object"></a>
The PhysicalTopologySource object</h1>
<p>The current topology is provided by a PhysicalTopologySource. When instantiated, a PhysicalTopologySource monitors for any connections from your computer to any Lightpad and Control Blocks and the <a class="el" href="classPhysicalTopologySource.html#a5b05bfe7c015f971273087312d21ea89" title="Returns the current physical topology.">PhysicalTopologySource::getCurrentTopology()</a> method returns the current BlockTopology.</p>
<p>In an environment where Lightpad and Control Blocks can be connected and disconnected dynamically it is convenient to register your code for <code class="project_code">topologyChanged()</code> callbacks from a PhysicalTopologySource. Then, when the current BlockTopology changes, your application is able to react to the new configuration. You can do this by inheriting from the <a class="el" href="structTopologySource_1_1Listener.html" title="Used to receive callbacks for topology changes.">TopologySource::Listener</a> class and registering as a listener to a PhysicalTopologySource object. When you inherit from TopologySource::Listener you must override the pure virtual method <a class="el" href="structTopologySource_1_1Listener.html#afe9485086e5d66f70a0a7990582081c2" title="Called for any change in topology - devices changed, connections changed, etc.">TopologySource::Listener::topologyChanged()</a>, which is then called by a PhysicalTopologySource on topology changes when you register as a listener.</p>
<p>A simple example is shown below.</p>
<p>BlockFinder.h: </p><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  ==============================================================================</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Copyright (c) 2021 - ROLI Ltd</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Permission to use, copy, modify, and/or distribute this software for any</span></div>
<div class="line"><span class="comment">   purpose with or without fee is hereby granted, provided that the above</span></div>
<div class="line"><span class="comment">   copyright notice and this permission notice appear in all copies.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ROLI LTD DISCLAIMS ALL WARRANTIES WITH</span></div>
<div class="line"><span class="comment">   REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY</span></div>
<div class="line"><span class="comment">   AND FITNESS. IN NO EVENT SHALL ROLI LTD BE LIABLE FOR ANY SPECIAL, DIRECT,</span></div>
<div class="line"><span class="comment">   INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM</span></div>
<div class="line"><span class="comment">   LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE</span></div>
<div class="line"><span class="comment">   OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR</span></div>
<div class="line"><span class="comment">   PERFORMANCE OF THIS SOFTWARE.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  ==============================================================================</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;BlocksHeader.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Monitors a PhysicalTopologySource for changes to the connected BLOCKS and</span></div>
<div class="line"><span class="comment">// prints some information about the BLOCKS that are available.</span></div>
<div class="line"><span class="keyword">class </span>BlockFinder : <span class="keyword">private</span> juce::TopologySource::Listener</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Register as a listener to the PhysicalTopologySource, so that we receive</span></div>
<div class="line">    <span class="comment">// callbacks in topologyChanged().</span></div>
<div class="line">    BlockFinder();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="comment">// Called by the PhysicalTopologySource when the BLOCKS topology changes.</span></div>
<div class="line">    <span class="keywordtype">void</span> topologyChanged() <span class="keyword">override</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The PhysicalTopologySource member variable which reports BLOCKS changes.</span></div>
<div class="line">    juce::PhysicalTopologySource pts;</div>
<div class="line">};</div>
</div><!-- fragment --><p>BlockFinder.cpp: </p><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">  ==============================================================================</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Copyright (c) 2021 - ROLI Ltd</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   Permission to use, copy, modify, and/or distribute this software for any</span></div>
<div class="line"><span class="comment">   purpose with or without fee is hereby granted, provided that the above</span></div>
<div class="line"><span class="comment">   copyright notice and this permission notice appear in all copies.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">   THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND ROLI LTD DISCLAIMS ALL WARRANTIES WITH</span></div>
<div class="line"><span class="comment">   REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY</span></div>
<div class="line"><span class="comment">   AND FITNESS. IN NO EVENT SHALL ROLI LTD BE LIABLE FOR ANY SPECIAL, DIRECT,</span></div>
<div class="line"><span class="comment">   INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM</span></div>
<div class="line"><span class="comment">   LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE</span></div>
<div class="line"><span class="comment">   OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR</span></div>
<div class="line"><span class="comment">   PERFORMANCE OF THIS SOFTWARE.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  ==============================================================================</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;BlockFinder.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>juce;</div>
<div class="line"> </div>
<div class="line">BlockFinder::BlockFinder()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Register to receive topologyChanged() callbacks from pts.</span></div>
<div class="line">    pts.addListener (<span class="keyword">this</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> BlockFinder::topologyChanged()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// We have a new topology, so find out what it isand store it in a local</span></div>
<div class="line">    <span class="comment">// variable.</span></div>
<div class="line">    <span class="keyword">auto</span> currentTopology = pts.getCurrentTopology();</div>
<div class="line">    Logger::writeToLog (<span class="stringliteral">&quot;\nNew BLOCKS topology.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The blocks member of a BlockTopology contains an array of blocks. Here we</span></div>
<div class="line">    <span class="comment">// loop over them and print some information.</span></div>
<div class="line">    Logger::writeToLog (<span class="stringliteral">&quot;Detected &quot;</span> + String (currentTopology.blocks.size()) + <span class="stringliteral">&quot; blocks:&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; block : currentTopology.blocks)</div>
<div class="line">    {</div>
<div class="line">        Logger::writeToLog (<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">        Logger::writeToLog (<span class="stringliteral">&quot;    Description:   &quot;</span> + block-&gt;getDeviceDescription());</div>
<div class="line">        Logger::writeToLog (<span class="stringliteral">&quot;    Battery level: &quot;</span> + String (block-&gt;getBatteryLevel()));</div>
<div class="line">        Logger::writeToLog (<span class="stringliteral">&quot;    UID:           &quot;</span> + String (block-&gt;uid));</div>
<div class="line">        Logger::writeToLog (<span class="stringliteral">&quot;    Serial number: &quot;</span> + block-&gt;serialNumber);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>When instantiated this class simply monitors for changes to the connected Lightpad and Control Blocks and prints some information about them to <code class="code">stdout</code>. Once you have the current BlockTopology object you have access to the available Block objects and can start to interact with them. A more complex application would probably do much more in the <code class="project_code">topologyChanged()</code> method&mdash;see the <a class="el" href="example_applications.html">Example JUCE Applications</a> page.</p>
<p>You can find this simple example in the <code class="filename">examples/BlockFinder/</code> directory of the BLOCKS-SDK and the following sections will build on top of this project. If you need help with downloading and installing the BLOCKS-SDK, please refer to <a class="el" href="the_standalone_blocks_sdk.html">The standalone BLOCKS SDK</a> section.</p>
<h1><a class="anchor" id="the_block_object"></a>
The Block object</h1>
<p>A <a class="el" href="classBlock.html" title="Represents an individual BLOCKS device.">Block</a> object is the main entry point for communicating between your application and any Lightpad and Control Blocks that are connected to your computer.</p>
<p>All the different Block types are subclasses of Block so they provide the same interface (see the <a class="el" href="classBlock.html" title="Represents an individual BLOCKS device.">Block</a> class documentation). About half of the Block public member functions return information about the physical device it represents. In the example code above you can see that we use some of these methods to query each Block about its current status. The more interesting Block methods return pointers to objects you can use to control and receive events from individual BLOCKS. More detail about these methods can be obtained from the following pages:</p>
<p><a class="el" href="getting_touch_events.html">Getting touch events</a></p>
<p><a class="el" href="getting_control_button_events.html">Getting control button events</a></p>
<p><a class="el" href="controlling_led_grids.html">Controlling LED grids</a></p>
<p><a class="el" href="controlling_led_strips.html">Controlling LED strips</a></p>
<p><a class="el" href="controlling_control_buttons.html">Controlling control buttons</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr class="footer"/>
<address class="footer"><small>All content &copy ROLI Ltd.</small></address><br/>
</body>
</html>
