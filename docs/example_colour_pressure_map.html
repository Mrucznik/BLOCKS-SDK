<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BLOCKS SDK: Colour Pressure Map</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The BLOCKS SDK
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('example_colour_pressure_map.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Colour Pressure Map </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="colour_pressure_map_introduction"></a>
Introduction</h1>
<p>Learn how to display coloured pressure maps on the Lightpad <a class="el" href="classBlock.html" title="Represents an individual BLOCKS device.">Block</a>.</p>
<p>Launch the BLOCKS CODE application and open the script called <code class="filename">ColourPressureMap.littlefoot</code>. You can find the script in the <code class="filename">littlefoot/scripts/Example Scripts</code> folder. If you don't have the BLOCKS CODE IDE installed on your system, please refer to the section <a class="el" href="getting_started_with_blocks_code.html">Getting started with BLOCKS CODE</a> for help.</p>
<h1><a class="anchor" id="colour_pressure_map_drawing_pressure_maps"></a>
Drawing Pressure Maps</h1>
<p>Let's start by drawing white pressure map points onto the screen whenever pressure is applied onto the touch surface of a Lightpad.</p>
<p>We start by clearing the display in the <a class="el" href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f" title="Use this method to draw the display.">repaint()</a> function using the <a class="el" href="group__LittleFootFunctions.html#gafaa5f070126ac5184a648b484e7cf276" title="Clears the display and sets all the LEDs to black.">clearDisplay()</a> function to reset the state of our LEDs. We than call two handy functions that are defined in the littlefoot language that allow us to draw and fade pressure points automatically. These are respectively the <a class="el" href="group__LittleFootFunctions.html#gaec8e0644ec59acd9af0696084d371c83" title="Draws the pressure map on the display.">drawPressureMap()</a> and <a class="el" href="group__LittleFootFunctions.html#ga6366c1bb2e2cd7fc0c3115bd53fe4a7e" title="Fades the pressure map on the display.">fadePressureMap()</a> functions.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f">repaint</a>()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#gafaa5f070126ac5184a648b484e7cf276">clearDisplay</a>();</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#gaec8e0644ec59acd9af0696084d371c83">drawPressureMap</a>();</div>
<div class="line">    <a class="code" href="group__LittleFootFunctions.html#ga6366c1bb2e2cd7fc0c3115bd53fe4a7e">fadePressureMap</a>();</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga6366c1bb2e2cd7fc0c3115bd53fe4a7e"><div class="ttname"><a href="group__LittleFootFunctions.html#ga6366c1bb2e2cd7fc0c3115bd53fe4a7e">fadePressureMap</a></div><div class="ttdeci">void fadePressureMap()</div><div class="ttdoc">Fades the pressure map on the display.</div></div>
<div class="ttc" id="agroup__LittleFootFunctions_html_gac827b978aa122f136a14c198687ad80f"><div class="ttname"><a href="group__LittleFootFunctions.html#gac827b978aa122f136a14c198687ad80f">repaint</a></div><div class="ttdeci">void repaint()</div><div class="ttdoc">Use this method to draw the display.</div></div>
<div class="ttc" id="agroup__LittleFootFunctions_html_gaec8e0644ec59acd9af0696084d371c83"><div class="ttname"><a href="group__LittleFootFunctions.html#gaec8e0644ec59acd9af0696084d371c83">drawPressureMap</a></div><div class="ttdeci">void drawPressureMap()</div><div class="ttdoc">Draws the pressure map on the display.</div></div>
<div class="ttc" id="agroup__LittleFootFunctions_html_gafaa5f070126ac5184a648b484e7cf276"><div class="ttname"><a href="group__LittleFootFunctions.html#gafaa5f070126ac5184a648b484e7cf276">clearDisplay</a></div><div class="ttdeci">void clearDisplay()</div><div class="ttdoc">Clears the display and sets all the LEDs to black.</div></div>
</div><!-- fragment --><p>However, if we run the script at the moment no pressure points are shown on the screen because we need to tell the program where to draw them by calling the <a class="el" href="group__LittleFootFunctions.html#ga6a5464c821a89b0367b2954090976ebf" title="Draws a pressure point with a specified colour and pressure.">addPressurePoint()</a> function with the colour and coordinates of the point.</p>
<p>The littlefoot language has several callback functions that are called when a special event happens. In our case we are interested in the start and movement of a touch gesture and therefore we can implement these as follows:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#ga1037467281f60ab95f5e5a305a41e73b">touchStart</a> (<span class="keywordtype">int</span> index, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z, <span class="keywordtype">float</span> vz)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="group__LittleFootFunctions.html#ga6a5464c821a89b0367b2954090976ebf">addPressurePoint</a> (0xffffff, x, y, z * 100.0);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga1037467281f60ab95f5e5a305a41e73b"><div class="ttname"><a href="group__LittleFootFunctions.html#ga1037467281f60ab95f5e5a305a41e73b">touchStart</a></div><div class="ttdeci">void touchStart(int index, float x, float y, float z, float vz)</div><div class="ttdoc">Called when a touch event starts.</div></div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga6a5464c821a89b0367b2954090976ebf"><div class="ttname"><a href="group__LittleFootFunctions.html#ga6a5464c821a89b0367b2954090976ebf">addPressurePoint</a></div><div class="ttdeci">void addPressurePoint(int argb, float touchX, float touchY, float touchZ)</div><div class="ttdoc">Draws a pressure point with a specified colour and pressure.</div></div>
</div><!-- fragment --><p>When the callback functions are called, we add a pressure point to the pressure map by specifying a colour in hexadecimal (in this case white is 0xffffff) and the coordinates of the touch event.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#ga288b1c5ca5024c5ca2c6ab58f3566dae">touchMove</a> (<span class="keywordtype">int</span> index, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z, <span class="keywordtype">float</span> vz)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="group__LittleFootFunctions.html#ga6a5464c821a89b0367b2954090976ebf">addPressurePoint</a> (0xffffff, x, y, z * 20.0);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__LittleFootFunctions_html_ga288b1c5ca5024c5ca2c6ab58f3566dae"><div class="ttname"><a href="group__LittleFootFunctions.html#ga288b1c5ca5024c5ca2c6ab58f3566dae">touchMove</a></div><div class="ttdeci">void touchMove(int index, float x, float y, float z, float vz)</div><div class="ttdoc">Called when a touch event moves.</div></div>
</div><!-- fragment --><p>Notice here that we multiply the depth z by a scaler in order to make the surface of the pressure point bigger and easier to see.</p>
<div class="image">
<img src="example_pressure_map.JPG" alt=""/>
<div class="caption">
White pressure map</div></div>
<h1><a class="anchor" id="colour_pressure_map_adding_colours"></a>
Adding Colours</h1>
<p>Now let's try to add different colours to the pressure points depending on the number of fingers on the screen. To make these variables accessible in realtime to the Parameters tab of the IDE, we create some variables in the metadata section of the code.</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">metadata</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Colour Pressure Map&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">variables</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">variable</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;pressureColour0&quot;</span> <span class="keyword">displayName</span>=<span class="stringliteral">&quot;Heat Colour 0&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;colour&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0xFF0000&quot;</span> /&gt;</div>
<div class="line">        &lt;<span class="keywordtype">variable</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;pressureColour1&quot;</span> <span class="keyword">displayName</span>=<span class="stringliteral">&quot;Heat Colour 1&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;colour&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0x00FF00&quot;</span> /&gt;</div>
<div class="line">        &lt;<span class="keywordtype">variable</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;pressureColour2&quot;</span> <span class="keyword">displayName</span>=<span class="stringliteral">&quot;Heat Colour 2&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;colour&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0x0000FF&quot;</span> /&gt;</div>
<div class="line">        &lt;<span class="keywordtype">variable</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;pressureColour3&quot;</span> <span class="keyword">displayName</span>=<span class="stringliteral">&quot;Heat Colour 3&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;colour&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0xFF00FF&quot;</span> /&gt;</div>
<div class="line">        &lt;<span class="keywordtype">variable</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;scaling&quot;</span>         <span class="keyword">displayName</span>=<span class="stringliteral">&quot;How hot!&quot;</span>      <span class="keyword">type</span>=<span class="stringliteral">&quot;float&quot;</span>  <span class="keyword">value</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">min</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;200&quot;</span> /&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">variables</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">metadata</span>&gt;</div>
</div><!-- fragment --><p>We also implement a helper function called getPressureColour() that takes an index of the finger from the touch event and returns the desired colour as shown below:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> getPressureColour (<span class="keywordtype">int</span> index)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> col = pressureColour3;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (index == 1)</div>
<div class="line">    {</div>
<div class="line">        col = pressureColour0;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index == 2)</div>
<div class="line">    {</div>
<div class="line">        col = pressureColour1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index == 3)</div>
<div class="line">    {</div>
<div class="line">        col = pressureColour2;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> col;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Finally we need to modify the callbacks to incorporate this helper function instead of hardcoding the colour white.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#ga1037467281f60ab95f5e5a305a41e73b">touchStart</a> (<span class="keywordtype">int</span> index, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z, <span class="keywordtype">float</span> vz)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="group__LittleFootFunctions.html#ga6a5464c821a89b0367b2954090976ebf">addPressurePoint</a> (getPressureColour (index), x, y, z * <span class="keywordtype">float</span> (scaling));</div>
<div class="line">}</div>
</div><!-- fragment --><p>Notice we also allow the scaling of the pressure point to be controlled by a slider in the Parameters tab in order to change its size in realtime.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__LittleFootFunctions.html#ga288b1c5ca5024c5ca2c6ab58f3566dae">touchMove</a> (<span class="keywordtype">int</span> index, <span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z, <span class="keywordtype">float</span> vz)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="group__LittleFootFunctions.html#ga6a5464c821a89b0367b2954090976ebf">addPressurePoint</a> (getPressureColour (index), x, y, z * <span class="keywordtype">float</span> (scaling));</div>
<div class="line">}</div>
</div><!-- fragment --><div class="image">
<img src="example_colour_pressure_map.JPG" alt=""/>
<div class="caption">
Colour pressure map</div></div>
<h1><a class="anchor" id="colour_pressure_map_summary"></a>
Summary</h1>
<p>In this example, we learnt how to display pressure maps onto the Lightpad and add colours depending on the number of fingers pressed onto the touch surface.</p>
<h1><a class="anchor" id="colour_pressure_map_see_also"></a>
See also</h1>
<ul>
<li><a class="el" href="example_dynamic_parameters.html">Dynamic Parameters</a></li>
<li><a class="el" href="example_tic_tac_toe.html">Tic Tac Toe</a></li>
<li><a class="el" href="example_music_gen.html">Music Gen</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr class="footer"/>
<address class="footer"><small>All content &copy ROLI Ltd.</small></address><br/>
</body>
</html>
