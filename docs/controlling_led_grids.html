<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BLOCKS SDK: Controlling LED grids</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The BLOCKS SDK
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('controlling_led_grids.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Controlling LED grids </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="controlling_led_grids_basic_usage"></a>
Basic usage</h1>
<p>An LED grid on a BLOCKS device can be controlled via an <a class="el" href="classLEDGrid.html" title="Represents a 2D grid of LEDs on a block device.">LEDGrid</a> object, which can be obtained from the <a class="el" href="classBlock.html#a6b5061298a0a23598edc5c204ff0458c" title="If this block has a grid of LEDs, this will return an object to control it.">Block::getLEDGrid()</a> function of a <a class="el" href="classBlock.html" title="Represents an individual BLOCKS device.">Block</a> &mdash; see the <a class="el" href="discovering_blocks.html">Discovering BLOCKS</a> section for details of how to obtain a Block object.</p>
<p>Using a LED grid requires a <a class="el" href="structBlock_1_1Program.html" title="A program that can be loaded onto a block.">Block::Program</a> to operate the LEDs. This program specifies some code to run on the device, and can also provide methods to be called from your application which can communicate with the code running on the device via a block of shared memory. The code which runs on the device must be specified using <a class="el" href="the_littlefoot_language.html">The LittleFoot Language</a>, which is described in the corresponding section. However, for a very wide range of applications, the <a class="el" href="structBitmapLEDProgram.html" title="A simple Program to set the colours of individual LEDs.">BitmapLEDProgram</a> provided with the BLOCKS SDK is sufficient and you will not need to create your own. Using a BitmapLEDProgram to change the colour of LEDs is demonstated below.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>BlockProgramExample</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// This should be called when doing the initial configuration of your application.</span></div>
<div class="line">    <span class="keywordtype">void</span> setBitmapLEDProgram (<a class="code" href="classBlock.html">Block</a>&amp; block)</div>
<div class="line">    {</div>
<div class="line">        block.<a class="code" href="classBlock.html#ad8951bbdae475bfea2d9b28bb3688d0e">setProgram</a> (<span class="keyword">new</span> <a class="code" href="structBitmapLEDProgram.html">BitmapLEDProgram</a> (block));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Once a BitmapLEDProgram is loaded we can use its setLED() method to change the</span></div>
<div class="line">    <span class="comment">// colour of LEDs on the corresponding device.</span></div>
<div class="line">    <span class="keywordtype">void</span> setLED (<a class="code" href="classBlock.html">Block</a>&amp; block, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <a class="code" href="structLEDColour.html">LEDColour</a> c)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">auto</span> program = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="structBitmapLEDProgram.html">BitmapLEDProgram</a>*<span class="keyword">&gt;</span> (block.<a class="code" href="classBlock.html#a403be8126dd2b96d440c942b6ab20e66">getProgram</a>()))</div>
<div class="line">            program-&gt;setLED (x, y, c);</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclassBlock_html"><div class="ttname"><a href="classBlock.html">Block</a></div><div class="ttdoc">Represents an individual BLOCKS device.</div><div class="ttdef"><b>Definition:</b> roli_Block.h:31</div></div>
<div class="ttc" id="aclassBlock_html_a403be8126dd2b96d440c942b6ab20e66"><div class="ttname"><a href="classBlock.html#a403be8126dd2b96d440c942b6ab20e66">Block::getProgram</a></div><div class="ttdeci">virtual Program * getProgram() const =0</div><div class="ttdoc">Returns a pointer to the currently loaded program.</div></div>
<div class="ttc" id="aclassBlock_html_ad8951bbdae475bfea2d9b28bb3688d0e"><div class="ttname"><a href="classBlock.html#ad8951bbdae475bfea2d9b28bb3688d0e">Block::setProgram</a></div><div class="ttdeci">virtual juce::Result setProgram(std::unique_ptr&lt; Program &gt;, ProgramPersistency persistency=ProgramPersistency::setAsTemp)=0</div><div class="ttdoc">Sets the Program to run on this block.</div></div>
<div class="ttc" id="astructBitmapLEDProgram_html"><div class="ttname"><a href="structBitmapLEDProgram.html">BitmapLEDProgram</a></div><div class="ttdoc">A simple Program to set the colours of individual LEDs.</div><div class="ttdef"><b>Definition:</b> roli_BitmapLEDProgram.h:31</div></div>
<div class="ttc" id="astructLEDColour_html"><div class="ttname"><a href="structLEDColour.html">LEDColour</a></div><div class="ttdoc">A simple ARGB colour class for setting LEDs.</div><div class="ttdef"><b>Definition:</b> roli_LEDGrid.h:31</div></div>
</div><!-- fragment --><h1><a class="anchor" id="controlling_led_grids_example_usage"></a>
Example usage</h1>
<p>To add this functionality to the BlockFinder example project, add the above functions to the BlockFinder class implementation. Then in the <code class="project_code">topologyChanged()</code> callback, check if the connected Block is a Lightpad and call the above functions as shown below:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> topologyChanged()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <span class="comment">//...</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; block : currentTopology.blocks)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//...</span></div>
<div class="line">        <span class="keywordflow">if</span> (block-&gt;<a class="code" href="classBlock.html#aa09e9ff13441f8c6689acb398870c715">getType</a>() == <a class="code" href="classBlock.html#a2c6b3c425b9b8cb708b23e553fa81324ae901f3708edf53ccf96ff94ff361a3fa">Block::lightPadBlock</a>)</div>
<div class="line">        {</div>
<div class="line">            setBitmapLEDProgram (*block);</div>
<div class="line">            setLED (*block, 7, 7, <a class="code" href="structLEDColour.html">LEDColour</a> (0xff00ff00));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclassBlock_html_a2c6b3c425b9b8cb708b23e553fa81324ae901f3708edf53ccf96ff94ff361a3fa"><div class="ttname"><a href="classBlock.html#a2c6b3c425b9b8cb708b23e553fa81324ae901f3708edf53ccf96ff94ff361a3fa">Block::lightPadBlock</a></div><div class="ttdeci">@ lightPadBlock</div><div class="ttdoc">Lightpad block type.</div><div class="ttdef"><b>Definition:</b> roli_Block.h:43</div></div>
<div class="ttc" id="aclassBlock_html_aa09e9ff13441f8c6689acb398870c715"><div class="ttname"><a href="classBlock.html#aa09e9ff13441f8c6689acb398870c715">Block::getType</a></div><div class="ttdeci">virtual Type getType() const =0</div><div class="ttdoc">Returns the type of this device.</div></div>
</div><!-- fragment --><p>If you run the application now and connect a Lightpad, you should see a single green dot displayed in the centre of the surface.</p>
<div class="image">
<img src="LEDGrids.JPG" alt=""/>
<div class="caption">
The LED grid on a Lightpad Block</div></div>
<h1><a class="anchor" id="controlling_led_grids_advanced_usage"></a>
Advanced Usage</h1>
<p>Using a custom Block::Program allows more precise control over the operation of the LEDs. The code which will actually execute on the device, returned by your overriden <a class="el" href="structBlock_1_1Program.html#a162fefdf847a319008d2384e97c492c4" title="Returns the LittleFoot program to execute on the BLOCKS device.">Block::Program::getLittleFootProgram()</a> function, must be specified in the LittleFoot language.</p>
<p>Learn more about other <a class="el" href="classBlock.html" title="Represents an individual BLOCKS device.">Block</a> methods from the following pages:</p>
<p><a class="el" href="getting_touch_events.html">Getting touch events</a></p>
<p><a class="el" href="getting_control_button_events.html">Getting control button events</a></p>
<p><a class="el" href="controlling_led_strips.html">Controlling LED strips</a></p>
<p><a class="el" href="controlling_control_buttons.html">Controlling control buttons</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr class="footer"/>
<address class="footer"><small>All content &copy ROLI Ltd.</small></address><br/>
</body>
</html>
